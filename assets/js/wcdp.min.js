jQuery(function(o){let c;function a(t){var e,c;n("#wcdp-ajax-send")&&(o("#wcdp-spinner").show(),o("#wcdp-ajax-button").hide(),c=(e=o("#wcdp-ajax-send")).serialize(),o.ajax({type:"POST",url:e.attr("action"),data:c}).done(function(e){!0===e.success?(o(".woocommerce-error").remove(),o("body").trigger("update_checkout"),o("#wcdp-ajax-button").show(),o("#wcdp-spinner").hide(),e.recurring?(o("#createaccount").prop("checked",!0).trigger("change"),o(".create-account:has(#createaccount)").hide()):o(".create-account:has(#createaccount)").show(),s(t)):d(e.message,e.reload,e.newParams)}).fail(function(){o("#wcdp-spinner").hide(),d(o(".wcdp-choose-donation").attr("wcdp-error-default"))}))}function n(e){var t=o("#variation_id");try{return o(e)[0].reportValidity()&&(0===t.length||""!=t.attr("value"))}catch(e){}}function d(e="An unexpected error occurred. Please reload the page and try again. If the problem persists, please contact our support team.",t=!0,a=!1){if(t||o("#wcdp-ajax-button").show(),a){alert(e);let c=new URL(window.location.href);Object.entries(a).forEach(([e,t])=>c.searchParams.set(e,t)),window.location.href=c.toString()}o("#wcdp-spinner").hide(),o("#wcdp-ajax-error").remove(),o("form.checkout.woocommerce-checkout").prepend('<ul class="woocommerce-error" id="wcdp-ajax-error" role="alert"><li></li></ul>'),o("#wcdp-ajax-error li").text(e)}o("#wcdp-ajax-send").on("submit",function(e){e.preventDefault();e=o("#wcdp-ajax-send").serialize();c!=e?(c=e,a("2")):s(2)});let e=0,i=(o(".wcdp-body > #wcdp-ajax-send").on("input blur keyup paste change",function(){c!=o("#wcdp-ajax-send").serialize()&&(e++,c=o("#wcdp-ajax-send").serialize(),setTimeout(function(){0==--e&&a()},1300))}),0),r=0,p=(o(".wcdp-body").on("input blur keyup paste change load",function(){const e=document.querySelector(".wcdp-body .single_add_to_cart_button");var t=document.querySelector("#wcdp-get-send");e&&t&&t.checkValidity()?e.classList.remove("disabled"):e&&e.classList.add("disabled"),o(".wcdp-express-amount").val(o("#wcdp-donation-amount").val()),i++,setTimeout(function(){0==--i&&r!=o("#wcdp-donation-amount").val()&&(r=o("#wcdp-donation-amount").val(),o(document.body).trigger("woocommerce_variation_has_changed"),e)&&e.classList.toggle("wcdp_price_changed")},500)}),1);function s(e){var t=o(":root")[0];switch(t.style.setProperty("--wcdp-step-2","var(--wcdp-main)"),t.style.setProperty("--wcdp-step-3","var(--wcdp-main)"),e){case"3":o("#wcdp-step-2").show(),o("form.checkout").find(".input-text:visible, select:visible, input:checkbox:visible").trigger("validate"),0<o("#wcdp-step-2 .woocommerce-invalid:visible").length?(o("#wcdp-invalid-fields").show(),o("#place_order").hide()):(o("#wcdp-invalid-fields").hide(),o("#place_order").show()),t.style.setProperty("--wcdp-step-3","var(--wcdp-main-2)");case"2":t.style.setProperty("--wcdp-step-2","var(--wcdp-main-2)");break;case"1":break;default:return}o(".wcdp-style5-active").removeClass("wcdp-style5-active"),o("#wcdp-style5-step-"+e).addClass("wcdp-style5-active"),o("#wcdp-progress-bar").css("width",33.33*(parseInt(e)-1)+"%"),o(".wcdp-tab").hide(),o("#wcdp-step-"+e).show(),p=e}o(".wcdp-form .wcdp-button, .wcdp-step").click(function(){var e,t=o(this).attr("value");1!=p?s(t):1!=t&&n("#wcdp-ajax-send")&&(e=o("#wcdp-ajax-send").serialize(),(c!=e?(c=e,a):s)(t))});let t=10;function u(){0<o("#wc-stripe-payment-request-button").children().length+o("#ppc-button, #ppc-button-ppcp-gateway").children().length?o(".wcdp-express-heading").show():t<1e4&&(t*=2,setTimeout(u,t))}o(document).ready(function(){o(".wcdp-loader").hide(),o(".wc-donation-platform").css({visibility:"visible","animation-name":"wcdp-appear-animation","animation-duration":"1s"}),h(!1);try{0!=o("#wcdp-donation-amount").val()&&o("#wcdp-ajax-send").trigger("change"),o(".wcdp-choose-donation")[0].checkValidity()&&(c=o("#wcdp-ajax-send").serialize(),a()),o(".woocommerce-checkout select").selectWoo()}finally{o("#wcdp-ajax-send,.wcdp_options").trigger("change"),setTimeout(u,t)}}),window.onhashchange=function(){h(!1)},o(".wcdp-modal-open").click(function(){h(!0)}),o(document).on("keypress","input",function(e){"Escape"==e.key&&w()}),o(".wcdp-modal-close").click(w);var l=!1;function w(){l&&(o(".wcdp-overlay").hide(),o("body").css("overflow-y"," auto"),history.pushState("",document.title,window.location.pathname+window.location.search),l=!1)}function h(e){var t=o(".wcdp-overlay");(e||"#wcdp-form"==location.hash&&0<t.length)&&(t.show(),o("body").css("overflow-y","hidden"),l=!0)}o(".wcdp_options").change(function(){var e=this.attributes["wcdp-name"].value,t=o('input[name="'+e+'"]:checked').val();t&&(o("#wcdp-"+e).val(t),(e=o("#"+e)).val(t),e.trigger("change"))}),o(document).on("change","#wcdp_fee_recovery",function(){setTimeout(function(){o("body").trigger("update_checkout")},400)}),o(document).on("change","input[name='payment_method']",function(){o("#wcdp_fee_recovery").prop("checked")&&setTimeout(function(){o("body").trigger("update_checkout")},400)}),o("#wcdp-range").on("input",function(){var e=o("#wcdp-range"),t=o("#wcdp-donation-amount");t.val(e.val()),e.val()==e.attr("max")&&t.select()}),o(".wcdp-amount-range-field").on("input",function(){o("#wcdp-range").val(o("#wcdp-donation-amount").val())}),o("#wcdp-donation-amount").on("change",function(){var e="#wcdp_value_"+o("#wcdp-donation-amount").val().replace(/./g,"-");(0==o(e).length?o("#wcdp_value_other"):o(e)).prop("checked",!0)}),o("#wcdp_value_other").click(function(){o("#wcdp-donation-amount").focus()}),o(".wcdp-choose-donation").on("change",function(){o(".wcdp_su input").each(function(){0==o("#"+this.name+' option[value="'+this.value+'"]').length?this.setAttribute("disabled","true"):this.removeAttribute("disabled")})})});

